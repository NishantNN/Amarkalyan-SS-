<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Notices</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background-color: #f5f5f5;
      padding: 20px;
      margin: 0;
    }

    .notice-container {
      background-color: #fff;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .notice-title {
      font-size: 24px;
      font-weight: bold;
      color: #333;
      margin-bottom: 10px;
    }

    .notice-desc {
      font-size: 16px;
      color: #555;
    }

    .notice-time {
      font-size: 14px;
      color: #888;
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <h3>Notices</h3>
  <div id="notices-list">
    <!-- Notices will be displayed here -->
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-app.js";
    import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDOskGbmFVPlHml61_SeUxNSHPDby5wUGc",
      authDomain: "amarkalyan-admin.firebaseapp.com",
      databaseURL: "https://amarkalyan-admin-default-rtdb.firebaseio.com",
      projectId: "amarkalyan-admin",
      storageBucket: "amarkalyan-admin.firebasestorage.app",
      messagingSenderId: "1040534177674",
      appId: "1:1040534177674:web:51b1f85fd85e33a53daa73",
      measurementId: "G-2Z1KZ13HGR"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const noticesRef = ref(db, 'notice');

    // Display Notices
    function displayNotices() {
      get(noticesRef).then((snapshot) => {
        const noticesList = document.getElementById("notices-list");
        noticesList.innerHTML = ''; // Clear current list

        if (snapshot.exists()) {
          const notices = snapshot.val();

          // Convert notices object into an array of [key, notice] pairs and sort by timestamp
          const sortedNotices = Object.entries(notices).sort((a, b) => new Date(b[1].Timestamp) - new Date(a[1].Timestamp));

          sortedNotices.forEach(([key, notice]) => {
            createNoticeElement(key, notice);
          });
        } else {
          noticesList.innerHTML = "<p>No notices available.</p>";
        }
      }).catch((error) => {
        console.error("Error fetching notices:", error);
      });
    }

    // Create and Display Notice Element
    function createNoticeElement(key, notice) {
  const noticesList = document.getElementById("notices-list");
  const noticeContainer = document.createElement("div");
  noticeContainer.classList.add("notice-container");

  const noticeTitle = document.createElement("div");
  noticeTitle.classList.add("notice-title");
  noticeTitle.textContent = notice.Title;

  const noticeDesc = document.createElement("div");
  noticeDesc.classList.add("notice-desc");
  noticeDesc.textContent = notice.Description;

  const noticeTime = document.createElement("div");
  noticeTime.classList.add("notice-time");
  noticeTime.textContent = `Posted on: ${new Date(notice.Timestamp).toLocaleString()}`;

  noticeContainer.appendChild(noticeTitle);
  noticeContainer.appendChild(noticeDesc);
  noticeContainer.appendChild(noticeTime);

  // Add a Download Button if PDF is available
  if (notice.PDFUrl) {
    const downloadButton = document.createElement("a");
    downloadButton.href = notice.PDFUrl;
    downloadButton.textContent = "Download PDF";
    downloadButton.target = "_blank";
    downloadButton.style.display = "inline-block";
    downloadButton.style.marginTop = "10px";
    downloadButton.style.padding = "8px 12px";
    downloadButton.style.backgroundColor = "#007bff";
    downloadButton.style.color = "white";
    downloadButton.style.borderRadius = "5px";
    downloadButton.style.textDecoration = "none";
    
    noticeContainer.appendChild(downloadButton);
  }

  noticesList.appendChild(noticeContainer);
}


    // Fetch and Display Notices on Page Load
    displayNotices();
  </script>

</body>
</html>
